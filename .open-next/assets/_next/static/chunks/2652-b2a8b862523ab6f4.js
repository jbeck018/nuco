"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2652],{2652:(e,t,s)=>{s.d(t,{IntegrationsList:()=>w});var n=s(95155),a=s(12115),i=s(35695),r=s(66320),l=s(80872),c=s(38703),d=s(30285),o=s(66695),u=s(54165),h=s(17313),x=s(26126),g=s(68856),m=s(88262),v=s(9503),p=s(71007),j=s(29911),f=s(59432),y=s(19373),N=s(5041),b=s(26715);function w(){let e=(0,l.n6)(),t=(0,i.useRouter)(),{currentOrganization:s}=(0,c.Z)(),[w,C]=(0,a.useState)("connected"),[k,A]=(0,a.useState)(null),[D,E]=(0,a.useState)(!1),[S,I]=(0,a.useState)(!1),{data:F,isLoading:Q,refetch:L}=(0,y.I)(e.integration.getAll.queryOptions(s?{organizationId:s.id}:void 0)),{data:q,isLoading:z}=(0,y.I)(e.integration.getAvailableTypes.queryOptions()),{data:T,isLoading:_}=(0,y.I)(e.integration.getAuthStatus.queryOptions());(0,a.useEffect)(()=>{},[s]);let O=(0,b.jE)(),R=(0,N.n)(e.integration.disconnect.mutationOptions({onMutate:async t=>{let{id:n}=t;await O.cancelQueries(e.integration.getAll.pathFilter());let a=O.getQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0));return O.setQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0),e=>e?e.map(e=>e.id===n?{...e,status:"disconnected",lastSynced:null}:e):e),E(!1),{previousData:a}},onSuccess:()=>{(0,m.oR)({title:"Integration disconnected",description:"The integration has been disconnected successfully."}),L(),O.invalidateQueries(e.integration.getAuthStatus.pathFilter()),t.refresh()},onError:(t,n,a)=>{(null==a?void 0:a.previousData)&&O.setQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0),a.previousData),(0,m.oR)({title:"Error",description:t.message||"Failed to disconnect integration",variant:"destructive"}),n.id&&(A(n.id),E(!0))},onSettled:()=>{O.invalidateQueries(e.integration.getAll.pathFilter())}})),$=(0,N.n)(e.integration.delete.mutationOptions({onMutate:async t=>{let{id:n}=t;await O.cancelQueries(e.integration.getAll.pathFilter());let a=O.getQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0));return O.setQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0),e=>e?e.filter(e=>e.id!==n):e),I(!1),{previousData:a}},onSuccess:()=>{(0,m.oR)({title:"Integration deleted",description:"The integration has been deleted successfully."}),L(),O.invalidateQueries(e.integration.getAuthStatus.pathFilter()),t.refresh()},onError:(t,n,a)=>{(null==a?void 0:a.previousData)&&O.setQueryData(e.integration.getAll.queryKey(s?{organizationId:s.id}:void 0),a.previousData),(0,m.oR)({title:"Error",description:t.message||"Failed to delete integration",variant:"destructive"}),n.id&&(A(n.id),I(!0))},onSettled:()=>{O.invalidateQueries(e.integration.getAll.pathFilter())}})),K=e=>{(0,r.Jv)(e,{callbackUrl:"/dashboard/integrations?type=".concat(e),redirect:!0})},U=e=>null==F?void 0:F.find(t=>t.type===e&&"connected"===t.status),P=e=>{var t;return!!T&&((null===(t=T[e])||void 0===t?void 0:t.isAuthenticated)||!1)},H=e=>{switch(e){case"salesforce":return"https://developer.salesforce.com/docs";case"hubspot":return"https://developers.hubspot.com/docs";case"google":return"https://developers.google.com/workspace";case"slack":return"https://api.slack.com/docs";default:return"#"}},M=e=>{switch(e){case"salesforce":return(0,n.jsx)(j.F3I,{className:"h-5 w-5 text-blue-600"});case"hubspot":return(0,n.jsx)(f.mM8,{className:"h-5 w-5 text-orange-500"});case"google":return(0,n.jsx)(j.DSS,{className:"h-5 w-5 text-red-500"});case"slack":return(0,n.jsx)(j.iWS,{className:"h-5 w-5 text-purple-500"});default:return(0,n.jsx)(j.DSS,{className:"h-5 w-5"})}};if(Q||z||_)return(0,n.jsx)("div",{className:"grid grid-cols-1 gap-6",children:[1,2,3].map(e=>(0,n.jsxs)(o.Card,{className:"overflow-hidden",children:[(0,n.jsxs)(o.CardHeader,{className:"pb-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(g.E,{className:"h-5 w-5 rounded-full"}),(0,n.jsx)(g.E,{className:"h-6 w-32"})]}),(0,n.jsx)(g.E,{className:"h-5 w-20 rounded-full"})]}),(0,n.jsx)(g.E,{className:"h-4 w-full mt-2"})]}),(0,n.jsx)(o.CardContent,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(g.E,{className:"h-3 w-3 rounded-full"}),(0,n.jsx)(g.E,{className:"h-4 w-32"})]}),(0,n.jsx)(g.E,{className:"h-4 w-40"})]})}),(0,n.jsxs)(o.CardFooter,{className:"flex justify-between",children:[(0,n.jsx)(g.E,{className:"h-4 w-24"}),(0,n.jsx)(g.E,{className:"h-9 w-28"})]})]},e))});let X=(null==F?void 0:F.length)||0,B=null==q?void 0:q.filter(e=>!(null==F?void 0:F.some(t=>t.type===e.type)));return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(h.tU,{defaultValue:"connected",value:w,onValueChange:e=>C(e),children:[(0,n.jsxs)(h.j7,{className:"mb-4",children:[(0,n.jsxs)(h.Xi,{value:"connected",children:["Connected (",X,")"]}),(0,n.jsx)(h.Xi,{value:"available",children:"Available"})]}),(0,n.jsx)(h.av,{value:"connected",className:"space-y-4",children:0===X?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("p",{className:"text-muted-foreground",children:"You don't have any connected integrations yet."}),(0,n.jsx)(d.$,{variant:"outline",className:"mt-4",onClick:()=>C("available"),children:"Browse available integrations"})]}):(0,n.jsx)("div",{className:"grid grid-cols-1 gap-6",children:null==F?void 0:F.map(e=>{var t,s;let a=U(e.type);return(0,n.jsxs)(o.Card,{className:"overflow-hidden",children:[(0,n.jsx)(o.CardHeader,{className:"pb-2",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(o.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:M(e.type)}),(0,n.jsx)("span",{className:"truncate",children:e.name})]}),(0,n.jsx)(x.E,{variant:"default",children:"Connected"})]})}),(0,n.jsx)(o.CardContent,{children:(0,n.jsx)("div",{className:"text-sm space-y-2",children:(0,n.jsx)("div",{className:"text-muted-foreground",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(p.A,{className:"h-3 w-3"}),(0,n.jsx)("span",{children:(null===(t=a.owner)||void 0===t?void 0:t.isCurrentUser)?"Connected by you":"Connected by ".concat((null===(s=a.owner)||void 0===s?void 0:s.name)||"Unknown")})]}),(0,n.jsxs)("div",{className:"mt-1",children:["Last synced: ",a.lastSynced?new Date(a.lastSynced).toLocaleString():"Never"]})]}):(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(p.A,{className:"h-3 w-3"}),(0,n.jsx)("span",{children:"Connected via OAuth"})]})})})}),(0,n.jsxs)(o.CardFooter,{className:"flex justify-between",children:[(0,n.jsx)("a",{href:H(e.type),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Documentation"}),(0,n.jsx)(d.$,{variant:"outline",onClick:()=>{a?(A(a.id),E(!0)):(0,m.oR)({title:"NextAuth Integration",description:"To disconnect this NextAuth integration, please visit your account settings."})},children:"Disconnect"})]})]},e.type)})})}),(0,n.jsx)(h.av,{value:"available",className:"space-y-4",children:(0,n.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(B||[]).map(e=>{let t=P(e.type),s=U(e.type);return(0,n.jsxs)(o.Card,{className:"overflow-hidden",children:[(0,n.jsxs)(o.CardHeader,{className:"pb-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(o.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:M(e.type)}),(0,n.jsx)("span",{className:"truncate",children:e.name})]}),t&&(0,n.jsx)(x.E,{variant:"default",children:"Connected"})]}),(0,n.jsx)(o.CardDescription,{className:"line-clamp-2",children:e.description})]}),(0,n.jsx)(o.CardContent,{children:(0,n.jsx)("div",{className:"text-sm space-y-2",children:t?(0,n.jsx)("div",{className:"text-muted-foreground",children:s?(0,n.jsxs)(n.Fragment,{children:["Connected as: ",s.name]}):(0,n.jsx)(n.Fragment,{children:"Connected via NextAuth"})}):(0,n.jsxs)("div",{className:"text-muted-foreground",children:["Connect to ",e.name," using NextAuth to access your data."]})})}),(0,n.jsxs)(o.CardFooter,{className:"flex justify-between",children:[(0,n.jsx)("a",{href:H(e.type),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Documentation"}),(0,n.jsx)(d.$,{variant:t?"outline":"default",onClick:()=>{t?s?(A(s.id),E(!0)):(0,m.oR)({title:"NextAuth Integration",description:"To disconnect this NextAuth integration, please visit your account settings."}):K(e.type)},children:t?"Disconnect":"Connect"})]})]},e.type)})})})]}),(0,n.jsx)(u.lG,{open:D,onOpenChange:E,children:(0,n.jsxs)(u.Cf,{children:[(0,n.jsxs)(u.c7,{children:[(0,n.jsx)(u.L3,{children:"Disconnect Integration"}),(0,n.jsx)(u.rr,{children:"Are you sure you want to disconnect this integration? You can reconnect it later."})]}),(0,n.jsxs)(u.Es,{children:[(0,n.jsx)(d.$,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,n.jsxs)(d.$,{variant:"destructive",onClick:()=>{if(k){let s=null==F?void 0:F.find(e=>e.id===k);s&&("google"===s.type||"salesforce"===s.type||"hubspot"===s.type||"slack"===s.type?R.mutate({id:k},{onSuccess:()=>{E(!1),(0,m.oR)({title:"Integration disconnected",description:"The integration has been disconnected successfully."}),L(),O.invalidateQueries(e.integration.getAuthStatus.pathFilter()),t.refresh()}}):R.mutate({id:k}))}},disabled:R.isPending,children:[R.isPending&&(0,n.jsx)(v.k,{className:"mr-2 h-4 w-4"}),"Disconnect"]})]})]})}),(0,n.jsx)(u.lG,{open:S,onOpenChange:I,children:(0,n.jsxs)(u.Cf,{children:[(0,n.jsxs)(u.c7,{children:[(0,n.jsx)(u.L3,{children:"Delete Integration"}),(0,n.jsx)(u.rr,{children:"Are you sure you want to delete this integration? This action cannot be undone."})]}),(0,n.jsxs)(u.Es,{children:[(0,n.jsx)(d.$,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),(0,n.jsxs)(d.$,{variant:"destructive",onClick:()=>{k&&$.mutate({id:k})},disabled:$.isPending,children:[$.isPending&&(0,n.jsx)(v.k,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]})}},9503:(e,t,s)=>{s.d(t,{k:()=>i});var n=s(95155),a=s(59434);function i(e){let{className:t,size:s="md",...i}=e;return(0,n.jsx)("div",{className:(0,a.cn)("inline-block animate-spin rounded-full border-2 border-solid border-current border-r-transparent",{"h-4 w-4":"sm"===s,"h-6 w-6":"md"===s,"h-8 w-8":"lg"===s},"text-primary",t),role:"status","aria-label":"loading",...i,children:(0,n.jsx)("span",{className:"sr-only",children:"Loading..."})})}},17313:(e,t,s)=>{s.d(t,{Xi:()=>c,av:()=>d,j7:()=>l,tU:()=>r});var n=s(95155);s(12115);var a=s(60704),i=s(59434);function r(e){let{className:t,...s}=e;return(0,n.jsx)(a.bL,{"data-slot":"tabs",className:(0,i.cn)("flex flex-col gap-2",t),...s})}function l(e){let{className:t,...s}=e;return(0,n.jsx)(a.B8,{"data-slot":"tabs-list",className:(0,i.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}function c(e){let{className:t,...s}=e;return(0,n.jsx)(a.l9,{"data-slot":"tabs-trigger",className:(0,i.cn)("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex items-center justify-center gap-2 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function d(e){let{className:t,...s}=e;return(0,n.jsx)(a.UC,{"data-slot":"tabs-content",className:(0,i.cn)("flex-1 outline-none",t),...s})}},68856:(e,t,s)=>{s.d(t,{E:()=>i});var n=s(95155),a=s(59434);function i(e){let{className:t,...s}=e;return(0,n.jsx)("div",{"data-slot":"skeleton",className:(0,a.cn)("bg-primary/10 animate-pulse rounded-md",t),...s})}}}]);