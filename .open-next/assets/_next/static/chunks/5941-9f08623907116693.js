"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5941],{9027:(e,t,r)=>{r.d(t,{m2:()=>f,NR:()=>m,Z9:()=>R,n_:()=>P,Ds:()=>j,hK:()=>y,sl:()=>N,cV:()=>C,cb:()=>g,$C:()=>v,u1:()=>b,zf:()=>_,v0:()=>x,WL:()=>w,GU:()=>A,N8:()=>I,ZZ:()=>E,eu:()=>k,ae:()=>$});var n=r(99143);let o=(e,t=21)=>(r=t)=>{let n="",o=0|r;for(;o--;)n+=e[Math.random()*e.length|0];return n};var a=r(83082),s=Object.defineProperty,i=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l=(e,t,r)=>i(e,"symbol"!=typeof t?t+"":t,r);class u extends Error{constructor(e,t){super(e),l(this,"type"),l(this,"field"),l(this,"value"),l(this,"line"),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function c(e){}class p extends TransformStream{constructor({onError:e,onRetry:t,onComment:r}={}){let n;super({start(o){n=function(e){let{onEvent:t=c,onError:r=c,onRetry:n=c,onComment:o}=e,a="",s=!0,i,l="",p="";function d(e){if(""===e){l.length>0&&t({id:i,event:p||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),i=void 0,l="",p="";return}if(e.startsWith(":")){o&&o(e.slice(e.startsWith(": ")?2:1));return}let r=e.indexOf(":");if(-1!==r){let t=e.slice(0,r),n=" "===e[r+1]?2:1;f(t,e.slice(r+n),e);return}f(e,"",e)}function f(e,t,o){switch(e){case"event":p=t;break;case"data":l=`${l}${t}
`;break;case"id":i=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?n(parseInt(t,10)):r(new u(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:o}));break;default:r(new u(`Unknown field "${e.length>20?`${e.slice(0,20)}\u2026`:e}"`,{type:"unknown-field",field:e,value:t,line:o}))}}return{feed:function(e){let t=s?e.replace(/^\xEF\xBB\xBF/,""):e,[r,n]=function(e){let t=[],r="",n=e.length;for(let o=0;o<n;o++){let n=e[o];"\r"===n&&e[o+1]===`
`?(t.push(r),r="",o++):"\r"===n||n===`
`?(t.push(r),r=""):r+=n}return[t,r]}(`${a}${t}`);for(let e of r)d(e);a=n,s=!1},reset:function(e={}){a&&e.consume&&d(a),i=void 0,l="",p="",a=""}}}({onEvent:e=>{o.enqueue(e)},onError(t){"terminate"===e?o.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:r})},transform(e){n.feed(e)}})}}var d=r(49509);function f(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function m(e){return new ReadableStream({async pull(t){try{let{value:r,done:n}=await e.next();n?t.close():t.enqueue(r)}catch(e){t.error(e)}},cancel(){}})}async function g(e){return null==e?Promise.resolve():new Promise(t=>setTimeout(t,e))}function h(e){let t={};return e.headers.forEach((e,r)=>{t[r]=e}),t}var y=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let s=o(r,t);if(null==e)return s;if(r.includes(a))throw new n.Di({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return t=>`${e}${a}${s(t)}`},v=y();function b(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}function _(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}function w({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:o}){if("string"==typeof e)return e;if(null!=e)throw new n.Kq({message:`${o} API key must be a string.`});if(void 0===d)throw new n.Kq({message:`${o} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(null==(e=d.env[t]))throw new n.Kq({message:`${o} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new n.Kq({message:`${o} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var k=Symbol.for("vercel.ai.validator");function E({value:e,schema:t}){var r;let o="object"==typeof t&&null!==t&&k in t&&!0===t[k]&&"validate"in t?t:(r=t,{[k]:!0,validate:e=>{let t=r.safeParse(e);return t.success?{success:!0,value:t.data}:{success:!1,error:t.error}}});try{if(null==o.validate)return{success:!0,value:e};let t=o.validate(e);if(t.success)return t;return{success:!1,error:n.iM.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:n.iM.wrap({value:e,cause:t})}}}function I({text:e,schema:t}){try{let r=a.parse(e);if(null==t)return{success:!0,value:r,rawValue:r};let n=E({value:r,schema:t});return n.success?{...n,rawValue:r}:n}catch(t){return{success:!1,error:n.u6.isInstance(t)?t:new n.u6({text:e,cause:t})}}}function x(e){try{return a.parse(e),!0}catch(e){return!1}}var S=()=>globalThis.fetch,A=async({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:a,fetch:s})=>T({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:a,fetch:s}),T=async({url:e,headers:t={},body:r,successfulResponseHandler:o,failedResponseHandler:a,abortSignal:s,fetch:i=S()})=>{try{var l;let u=await i(e,{method:"POST",headers:(l=t,Object.fromEntries(Object.entries(l).filter(([e,t])=>null!=t))),body:r.content,signal:s}),c=h(u);if(!u.ok){let t;try{t=await a({response:u,url:e,requestBodyValues:r.values})}catch(t){if(_(t)||n.hL.isInstance(t))throw t;throw new n.hL({message:"Failed to process error response",cause:t,statusCode:u.status,url:e,responseHeaders:c,requestBodyValues:r.values})}throw t.value}try{return await o({response:u,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(_(t)||n.hL.isInstance(t)))throw t;throw new n.hL({message:"Failed to process successful response",cause:t,statusCode:u.status,url:e,responseHeaders:c,requestBodyValues:r.values})}}catch(t){if(_(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let o=t.cause;if(null!=o)throw new n.hL({message:`Cannot connect to API: ${o.message}`,cause:o,url:e,requestBodyValues:r.values,isRetryable:!0})}throw t}},N=({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:o,url:s,requestBodyValues:i})=>{let l=await o.text(),u=h(o);if(""===l.trim())return{responseHeaders:u,value:new n.hL({message:o.statusText,url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:u,responseBody:l,isRetryable:null==r?void 0:r(o)})};try{let c=function({text:e,schema:t}){try{let r=a.parse(e);if(null==t)return r;return function({value:e,schema:t}){let r=E({value:e,schema:t});if(!r.success)throw n.iM.wrap({value:e,cause:r.error});return r.value}({value:r,schema:t})}catch(t){if(n.u6.isInstance(t)||n.iM.isInstance(t))throw t;throw new n.u6({text:e,cause:t})}}({text:l,schema:e});return{responseHeaders:u,value:new n.hL({message:t(c),url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:u,responseBody:l,data:c,isRetryable:null==r?void 0:r(o,c)})}}catch(e){return{responseHeaders:u,value:new n.hL({message:o.statusText,url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:u,responseBody:l,isRetryable:null==r?void 0:r(o)})}}},j=e=>async({response:t})=>{let r=h(t);if(null==t.body)throw new n.Tt({});return{responseHeaders:r,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new p).pipeThrough(new TransformStream({transform({data:t},r){"[DONE]"!==t&&r.enqueue(I({text:t,schema:e}))}}))}},C=e=>async({response:t,url:r,requestBodyValues:o})=>{let a=await t.text(),s=I({text:a,schema:e}),i=h(t);if(!s.success)throw new n.hL({message:"Invalid JSON response",cause:s.error,statusCode:t.status,responseHeaders:i,responseBody:a,url:r,requestBodyValues:o});return{responseHeaders:i,value:s.value,rawValue:s.rawValue}},{btoa:z,atob:O}=globalThis;function R(e){let t=O(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function P(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return z(t)}function $(e){return null==e?void 0:e.replace(/\/$/,"")}},12486:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(19946).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},19946:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(12115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:u="",children:c,iconNode:p,...d}=e;return(0,n.createElement)("svg",{ref:t,...s,width:o,height:o,stroke:r,strokeWidth:l?24*Number(i)/Number(o):i,className:a("lucide",u),...d},[...p.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),l=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:l,...u}=r;return(0,n.createElement)(i,{ref:s,iconNode:t,className:a("lucide-".concat(o(e)),l),...u})});return r.displayName="".concat(e),r}},21053:(e,t,r)=>{var n;r.d(t,{s:()=>n}),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(n||(n={}))},39033:(e,t,r)=>{r.d(t,{c:()=>o});var n=r(12115);function o(e){let t=n.useRef(e);return n.useEffect(()=>{t.current=e}),n.useMemo(()=>(...e)=>t.current?.(...e),[])}},46081:(e,t,r)=>{r.d(t,{A:()=>s,q:()=>a});var n=r(12115),o=r(95155);function a(e,t){let r=n.createContext(t),a=e=>{let{children:t,...a}=e,s=n.useMemo(()=>a,Object.values(a));return(0,o.jsx)(r.Provider,{value:s,children:t})};return a.displayName=e+"Provider",[a,function(o){let a=n.useContext(r);if(a)return a;if(void 0!==t)return t;throw Error(`\`${o}\` must be used within \`${e}\``)}]}function s(e,t=[]){let r=[],a=()=>{let t=r.map(e=>n.createContext(e));return function(r){let o=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:o}}),[r,o])}};return a.scopeName=e,[function(t,a){let s=n.createContext(a),i=r.length;r=[...r,a];let l=t=>{let{scope:r,children:a,...l}=t,u=r?.[e]?.[i]||s,c=n.useMemo(()=>l,Object.values(l));return(0,o.jsx)(u.Provider,{value:c,children:a})};return l.displayName=t+"Provider",[l,function(r,o){let l=o?.[e]?.[i]||s,u=n.useContext(l);if(u)return u;if(void 0!==a)return a;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let o=r.reduce((t,{useScope:r,scopeName:n})=>{let o=r(e)[`__scope${n}`];return{...t,...o}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}(a,...t)]}},52712:(e,t,r)=>{r.d(t,{N:()=>o});var n=r(12115),o=globalThis?.document?n.useLayoutEffect:()=>{}},63655:(e,t,r)=>{r.d(t,{hO:()=>l,sG:()=>i});var n=r(12115),o=r(47650),a=r(99708),s=r(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=n.forwardRef((e,r)=>{let{asChild:n,...o}=e,i=n?a.DX:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(i,{...o,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function l(e,t){e&&o.flushSync(()=>e.dispatchEvent(t))}},68764:(e,t,r)=>{let n;r.d(t,{mD:()=>X,H4:()=>K,d1:()=>U});var o=r(9027);let a=Symbol("Let zodToJsonSchema decide on which parser to use"),s={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},i=e=>"string"==typeof e?{...s,name:e}:{...s,...e},l=e=>{let t=i(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};var u=r(55594);function c(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function p(e,t,r,n,o){e[t]=r,c(e,t,n,o)}function d(e,t){return j(e.type._def,t)}let f=(e,t)=>j(e.innerType._def,t),m=(e,t)=>{let r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(let n of e.checks)switch(n.kind){case"min":p(r,"minimum",n.value,n.message,t);break;case"max":p(r,"maximum",n.value,n.message,t)}return r},g=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,h={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===n&&(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function y(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case"min":p(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t);break;case"max":p(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"email":switch(t.emailStrategy){case"format:email":_(r,"email",n.message,t);break;case"format:idn-email":_(r,"idn-email",n.message,t);break;case"pattern:zod":w(r,h.email,n.message,t)}break;case"url":_(r,"uri",n.message,t);break;case"uuid":_(r,"uuid",n.message,t);break;case"regex":w(r,n.regex,n.message,t);break;case"cuid":w(r,h.cuid,n.message,t);break;case"cuid2":w(r,h.cuid2,n.message,t);break;case"startsWith":w(r,RegExp(`^${v(n.value,t)}`),n.message,t);break;case"endsWith":w(r,RegExp(`${v(n.value,t)}$`),n.message,t);break;case"datetime":_(r,"date-time",n.message,t);break;case"date":_(r,"date",n.message,t);break;case"time":_(r,"time",n.message,t);break;case"duration":_(r,"duration",n.message,t);break;case"length":p(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t),p(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"includes":w(r,RegExp(v(n.value,t)),n.message,t);break;case"ip":"v6"!==n.version&&_(r,"ipv4",n.message,t),"v4"!==n.version&&_(r,"ipv6",n.message,t);break;case"base64url":w(r,h.base64url,n.message,t);break;case"jwt":w(r,h.jwt,n.message,t);break;case"cidr":"v6"!==n.version&&w(r,h.ipv4Cidr,n.message,t),"v4"!==n.version&&w(r,h.ipv6Cidr,n.message,t);break;case"emoji":w(r,h.emoji(),n.message,t);break;case"ulid":w(r,h.ulid,n.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":_(r,"binary",n.message,t);break;case"contentEncoding:base64":p(r,"contentEncoding","base64",n.message,t);break;case"pattern:zod":w(r,h.base64,n.message,t)}break;case"nanoid":w(r,h.nanoid,n.message,t);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function v(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)b.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}let b=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function _(e,t,r,n){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):p(e,"format",t,r,n)}function w(e,t,r,n){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:k(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):p(e,"pattern",k(t,n),r,n)}function k(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=r.i?e.source.toLowerCase():e.source,o="",a=!1,s=!1,i=!1;for(let e=0;e<n.length;e++){if(a){o+=n[e],a=!1;continue}if(r.i){if(s){if(n[e].match(/[a-z]/)){i?(o+=n[e],o+=`${n[e-2]}-${n[e]}`.toUpperCase(),i=!1):"-"===n[e+1]&&n[e+2]?.match(/[a-z]/)?(o+=n[e],i=!0):o+=`${n[e]}${n[e].toUpperCase()}`;continue}}else if(n[e].match(/[a-z]/)){o+=`[${n[e]}${n[e].toUpperCase()}]`;continue}}if(r.m){if("^"===n[e]){o+=`(^|(?<=[\r
]))`;continue}if("$"===n[e]){o+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===n[e]){o+=s?`${n[e]}\r
`:`[${n[e]}\r
]`;continue}o+=n[e],"\\"===n[e]?a=!0:s&&"]"===n[e]?s=!1:s||"["!==n[e]||(s=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}function E(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===u.kY.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,n)=>({...r,[n]:j(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",n]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:j(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===u.kY.ZodString&&e.keyType._def.checks?.length){let{type:n,...o}=y(e.keyType._def,t);return{...r,propertyNames:o}}if(e.keyType?._def.typeName===u.kY.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===u.kY.ZodBranded&&e.keyType._def.type._def.typeName===u.kY.ZodString&&e.keyType._def.type._def.checks?.length){let{type:n,...o}=d(e.keyType._def,t);return{...r,propertyNames:o}}return r}let I={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},x=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>j(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},S=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return j(e.innerType._def,t);let r=j(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},A=(e,t)=>{if("input"===t.pipeStrategy)return j(e.in._def,t);if("output"===t.pipeStrategy)return j(e.out._def,t);let r=j(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=j(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(e=>void 0!==e)}},T=(e,t)=>j(e.innerType._def,t),N=(e,t,r)=>{switch(t){case u.kY.ZodString:return y(e,r);case u.kY.ZodNumber:return function(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"int":r.type="integer",c(r,"type",n.message,t);break;case"min":"jsonSchema7"===t.target?n.inclusive?p(r,"minimum",n.value,n.message,t):p(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),p(r,"minimum",n.value,n.message,t));break;case"max":"jsonSchema7"===t.target?n.inclusive?p(r,"maximum",n.value,n.message,t):p(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),p(r,"maximum",n.value,n.message,t));break;case"multipleOf":p(r,"multipleOf",n.value,n.message,t)}return r}(e,r);case u.kY.ZodObject:return function(e,t){let r="openAi"===t.target,n={type:"object",...Object.entries(e.shape()).reduce((e,[n,o])=>{if(void 0===o||void 0===o._def)return e;let a=o.isOptional();a&&r&&(o instanceof u.Ii&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),a=!1);let s=j(o._def,{...t,currentPath:[...t.currentPath,"properties",n],propertyPath:[...t.currentPath,"properties",n]});return void 0===s?e:{properties:{...e.properties,[n]:s},required:a?e.required:[...e.required,n]}},{properties:{},required:[]}),additionalProperties:"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:j(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:j(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return n.required.length||delete n.required,n}(e,r);case u.kY.ZodBigInt:return function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"min":"jsonSchema7"===t.target?n.inclusive?p(r,"minimum",n.value,n.message,t):p(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),p(r,"minimum",n.value,n.message,t));break;case"max":"jsonSchema7"===t.target?n.inclusive?p(r,"maximum",n.value,n.message,t):p(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),p(r,"maximum",n.value,n.message,t));break;case"multipleOf":p(r,"multipleOf",n.value,n.message,t)}return r}(e,r);case u.kY.ZodBoolean:return{type:"boolean"};case u.kY.ZodDate:return function e(t,r,n){let o=n??r.dateStrategy;if(Array.isArray(o))return{anyOf:o.map((n,o)=>e(t,r,n))};switch(o){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return m(t,r)}}(e,r);case u.kY.ZodUndefined:return{not:{}};case u.kY.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case u.kY.ZodArray:return function(e,t){let r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==u.kY.ZodAny&&(r.items=j(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&p(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&p(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(p(r,"minItems",e.exactLength.value,e.exactLength.message,t),p(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}(e,r);case u.kY.ZodUnion:case u.kY.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return x(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in I&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=I[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return x(e,t)}(e,r);case u.kY.ZodIntersection:return function(e,t){let r=[j(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),j(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),n="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(e=>{if(g(e))o.push(...e.allOf),void 0===e.unevaluatedProperties&&(n=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}else n=void 0;o.push(t)}}),o.length?{allOf:o,...n}:void 0}(e,r);case u.kY.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>j(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:j(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>j(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case u.kY.ZodRecord:return E(e,r);case u.kY.ZodLiteral:return function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}(e,r);case u.kY.ZodEnum:return{type:"string",enum:Array.from(e.values)};case u.kY.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(e);case u.kY.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:I[e.innerType._def.typeName],nullable:!0}:{type:[I[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=j(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=j(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case u.kY.ZodOptional:return S(e,r);case u.kY.ZodMap:return function(e,t){return"record"===t.mapStrategy?E(e,t):{type:"array",maxItems:125,items:{type:"array",items:[j(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},j(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case u.kY.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:j(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&p(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&p(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}(e,r);case u.kY.ZodLazy:return()=>e.getter()._def;case u.kY.ZodPromise:return j(e.type._def,r);case u.kY.ZodNaN:case u.kY.ZodNever:return{not:{}};case u.kY.ZodEffects:return function(e,t){return"input"===t.effectStrategy?j(e.schema._def,t):{}}(e,r);case u.kY.ZodAny:case u.kY.ZodUnknown:return{};case u.kY.ZodDefault:return function(e,t){return{...j(e.innerType._def,t),default:e.defaultValue()}}(e,r);case u.kY.ZodBranded:return d(e,r);case u.kY.ZodReadonly:return T(e,r);case u.kY.ZodCatch:return f(e,r);case u.kY.ZodPipeline:return A(e,r);case u.kY.ZodFunction:case u.kY.ZodVoid:case u.kY.ZodSymbol:default:return}};function j(e,t,r=!1){let n=t.seen.get(e);if(t.override){let o=t.override?.(e,t,n,r);if(o!==a)return o}if(n&&!r){let e=C(n,t);if(void 0!==e)return e}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let s=N(e,e.typeName,t),i="function"==typeof s?j(s(),t):s;if(i&&O(e,t,i),t.postProcess){let r=t.postProcess(i,e,t);return o.jsonSchema=i,r}return o.jsonSchema=i,i}let C=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:z(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},z=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},O=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r),R=(e,t)=>{let r=l(t),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,n])=>({...e,[t]:j(n._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??{}}),{}):void 0,o="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,a=j(e._def,void 0===o?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??{},s="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(a.title=s);let i=void 0===o?n?{...a,[r.definitionPath]:n}:a:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:a}};return"jsonSchema7"===r.target?i.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===r.target||"openAi"===r.target)&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};var P={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},$={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},M={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},L={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},D={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},F=[P,$,M,L,D],Z={[P.code]:P,[$.code]:$,[M.code]:M,[L.code]:L,[D.code]:D};P.name,P.code,$.name,$.code,M.name,M.code,L.name,L.code,D.name,D.code;var Y=F.map(e=>e.code);function U(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=(0,o.N8)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=(0,o.N8)({text:function(e){let t=["ROOT"],r=-1,n=null;function o(e,o,a){switch(e){case'"':r=o,t.pop(),t.push(a),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,n=o,t.pop(),t.push(a),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(a),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(a),t.push("INSIDE_ARRAY_START")}}function a(e,n){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=n,t.pop()}}function s(e,n){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=n,t.pop()}}for(let i=0;i<e.length;i++){let l=e[i];switch(t[t.length-1]){case"ROOT":o(l,i,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=i,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,i,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":a(l,i);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=i;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=i}break;case"INSIDE_ARRAY_START":"]"===l?(r=i,t.pop()):(r=i,o(l,i,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=i,t.pop();break;default:r=i}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,i,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=i;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=i;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,i),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(l,i);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(l,i);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,i);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(n,i+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=i:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?a(l,i):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,i))}}}let i=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":i+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":i+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":i+="]";break;case"INSIDE_LITERAL":{let t=e.substring(n,e.length);"true".startsWith(t)?i+="true".slice(t.length):"false".startsWith(t)?i+="false".slice(t.length):"null".startsWith(t)&&(i+="null".slice(t.length))}}return i}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}var B=[{code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},{code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},{code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},{code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},{code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},{code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},{code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},{code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},{code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},{code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},{code:"f",name:"start_step",parse:e=>{if(null==e||"object"!=typeof e||!("messageId"in e)||"string"!=typeof e.messageId)throw Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},{code:"g",name:"reasoning",parse:e=>{if("string"!=typeof e)throw Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},{code:"h",name:"source",parse:e=>{if(null==e||"object"!=typeof e)throw Error('"source" parts expect a Source object.');return{type:"source",value:e}}},{code:"i",name:"redacted_reasoning",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data)throw Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},{code:"j",name:"reasoning_signature",parse:e=>{if(null==e||"object"!=typeof e||!("signature"in e)||"string"!=typeof e.signature)throw Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}}],q=Object.fromEntries(B.map(e=>[e.code,e]));Object.fromEntries(B.map(e=>[e.name,e.code]));var V=B.map(e=>e.code),J=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let r=e.slice(0,t);if(!V.includes(r))throw Error(`Failed to parse stream string. Invalid code ${r}.`);let n=JSON.parse(e.slice(t+1));return q[r].parse(n)};function K(e,t){let r=B.find(t=>t.name===e);if(!r)throw Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}
`}async function G({stream:e,onTextPart:t,onReasoningPart:r,onReasoningSignaturePart:n,onRedactedReasoningPart:o,onSourcePart:a,onDataPart:s,onErrorPart:i,onToolCallStreamingStartPart:l,onToolCallDeltaPart:u,onToolCallPart:c,onToolResultPart:p,onMessageAnnotationsPart:d,onFinishMessagePart:f,onFinishStepPart:m,onStartStepPart:g}){let h=e.getReader(),y=new TextDecoder,v=[],b=0;for(;;){let{value:e}=await h.read();if(e&&(v.push(e),b+=e.length,10!==e[e.length-1]))continue;if(0===v.length)break;let _=function(e,t){let r=new Uint8Array(t),n=0;for(let t of e)r.set(t,n),n+=t.length;return e.length=0,r}(v,b);for(let{type:e,value:h}of(b=0,y.decode(_,{stream:!0}).split("\n").filter(e=>""!==e).map(J)))switch(e){case"text":await (null==t?void 0:t(h));break;case"reasoning":await (null==r?void 0:r(h));break;case"reasoning_signature":await (null==n?void 0:n(h));break;case"redacted_reasoning":await (null==o?void 0:o(h));break;case"source":await (null==a?void 0:a(h));break;case"data":await (null==s?void 0:s(h));break;case"error":await (null==i?void 0:i(h));break;case"message_annotations":await (null==d?void 0:d(h));break;case"tool_call_streaming_start":await (null==l?void 0:l(h));break;case"tool_call_delta":await (null==u?void 0:u(h));break;case"tool_call":await (null==c?void 0:c(h));break;case"tool_result":await (null==p?void 0:p(h));break;case"finish_message":await (null==f?void 0:f(h));break;case"finish_step":await (null==m?void 0:m(h));break;case"start_step":await (null==g?void 0:g(h));break;default:throw Error(`Unknown stream part type: ${e}`)}}}async function W({stream:e,onTextPart:t}){let r=e.pipeThrough(new TextDecoderStream).getReader();for(;;){let{done:e,value:n}=await r.read();if(e)break;await t(n)}}var H=Symbol.for("vercel.ai.schema");function X(e){return"object"==typeof e&&null!==e&&H in e&&!0===e[H]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[H]:!0,_type:void 0,[o.eu]:!0,jsonSchema:e,validate:t}}(R(e,{$refStrategy:"none",target:"jsonSchema7"}),{validate:t=>{let r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}},72480:(e,t,r)=>{r.d(t,{N:()=>A});var n=r(9027),o=r(99143),a=r(55594);function s(e){var t,r;return null!=(r=null==(t=null==e?void 0:e.content)?void 0:t.map(({token:e,logprob:t,top_logprobs:r})=>({token:e,logprob:t,topLogprobs:r?r.map(({token:e,logprob:t})=>({token:e,logprob:t})):[]})))?r:void 0}function i(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var l=a.z.object({error:a.z.object({message:a.z.string(),type:a.z.string().nullish(),param:a.z.any().nullish(),code:a.z.union([a.z.string(),a.z.number()]).nullish()})}),u=(0,n.sl)({errorSchema:l,errorToMessage:e=>e.error.message});function c({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}var p=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r}get supportsStructuredOutputs(){var e;return null!=(e=this.settings.structuredOutputs)?e:g(this.modelId)}get defaultObjectGenerationMode(){return this.modelId.startsWith("gpt-4o-audio-preview")?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:r,temperature:a,topP:s,topK:i,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:p,seed:d,providerMetadata:f}){var m,y,v,b,_,w,k,E;let I=e.type,x=[];null!=i&&x.push({type:"unsupported-setting",setting:"topK"}),(null==p?void 0:p.type)!=="json"||null==p.schema||this.supportsStructuredOutputs||x.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let S=this.settings.useLegacyFunctionCalling;if(S&&!0===this.settings.parallelToolCalls)throw new o.b8({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(S&&this.supportsStructuredOutputs)throw new o.b8({functionality:"structuredOutputs with useLegacyFunctionCalling"});"remove"===h(this.modelId)&&t.some(e=>"system"===e.role)&&x.push({type:"other",message:"system messages are removed for this model"});let A={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:!0===this.settings.logprobs||"number"==typeof this.settings.logprobs||void 0,top_logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:a,top_p:s,frequency_penalty:l,presence_penalty:u,response_format:(null==p?void 0:p.type)==="json"?this.supportsStructuredOutputs&&null!=p.schema?{type:"json_schema",json_schema:{schema:p.schema,strict:!0,name:null!=(m=p.name)?m:"response",description:p.description}}:{type:"json_object"}:void 0,stop:c,seed:d,max_completion_tokens:null==(y=null==f?void 0:f.openai)?void 0:y.maxCompletionTokens,store:null==(v=null==f?void 0:f.openai)?void 0:v.store,metadata:null==(b=null==f?void 0:f.openai)?void 0:b.metadata,prediction:null==(_=null==f?void 0:f.openai)?void 0:_.prediction,reasoning_effort:null!=(k=null==(w=null==f?void 0:f.openai)?void 0:w.reasoningEffort)?k:this.settings.reasoningEffort,messages:function({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:r="system"}){let a=[];for(let{role:s,content:i}of e)switch(s){case"system":switch(r){case"system":a.push({role:"system",content:i});break;case"developer":a.push({role:"developer",content:i});break;case"remove":break;default:throw Error(`Unsupported system message mode: ${r}`)}break;case"user":if(1===i.length&&"text"===i[0].type){a.push({role:"user",content:i[0].text});break}a.push({role:"user",content:i.map(e=>{var t,r,a;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${(0,n.n_)(e.image)}`,detail:null==(a=null==(r=e.providerMetadata)?void 0:r.openai)?void 0:a.imageDetail}};case"file":if(e.data instanceof URL)throw new o.b8({functionality:"'File content parts with URL data' functionality not supported."});switch(e.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:e.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:e.data,format:"mp3"}};default:throw new o.b8({functionality:`File content part type ${e.mimeType} in user messages`})}}})});break;case"assistant":{let e="",r=[];for(let t of i)switch(t.type){case"text":e+=t.text;break;case"redacted-reasoning":case"reasoning":break;case"tool-call":r.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}});break;default:throw Error(`Unsupported part: ${t}`)}if(t){if(r.length>1)throw new o.b8({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});a.push({role:"assistant",content:e,function_call:r.length>0?r[0].function:void 0})}else a.push({role:"assistant",content:e,tool_calls:r.length>0?r:void 0});break}case"tool":for(let e of i)t?a.push({role:"function",name:e.toolName,content:JSON.stringify(e.result)}):a.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${s}`)}return a}({prompt:t,useLegacyFunctionCalling:S,systemMessageMode:h(this.modelId)})};switch(g(this.modelId)&&(null!=A.temperature&&(A.temperature=void 0,x.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=A.top_p&&(A.top_p=void 0,x.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=A.frequency_penalty&&(A.frequency_penalty=void 0,x.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=A.presence_penalty&&(A.presence_penalty=void 0,x.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=A.logit_bias&&(A.logit_bias=void 0,x.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=A.logprobs&&(A.logprobs=void 0,x.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=A.top_logprobs&&(A.top_logprobs=void 0,x.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=A.max_tokens&&(null==A.max_completion_tokens&&(A.max_completion_tokens=A.max_tokens),A.max_tokens=void 0)),I){case"regular":{let{tools:t,tool_choice:r,functions:n,function_call:a,toolWarnings:s}=function({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:r}){var n;let a=(null==(n=e.tools)?void 0:n.length)?e.tools:void 0,s=[];if(null==a)return{tools:void 0,tool_choice:void 0,toolWarnings:s};let i=e.toolChoice;if(t){let e=[];for(let t of a)"provider-defined"===t.type?s.push({type:"unsupported-tool",tool:t}):e.push({name:t.name,description:t.description,parameters:t.parameters});if(null==i)return{functions:e,function_call:void 0,toolWarnings:s};switch(i.type){case"auto":case"none":case void 0:return{functions:e,function_call:void 0,toolWarnings:s};case"required":throw new o.b8({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:e,function_call:{name:i.toolName},toolWarnings:s}}}let l=[];for(let e of a)"provider-defined"===e.type?s.push({type:"unsupported-tool",tool:e}):l.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters,strict:!!r||void 0}});if(null==i)return{tools:l,tool_choice:void 0,toolWarnings:s};let u=i.type;switch(u){case"auto":case"none":case"required":return{tools:l,tool_choice:u,toolWarnings:s};case"tool":return{tools:l,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:throw new o.b8({functionality:`Unsupported tool choice type: ${u}`})}}({mode:e,useLegacyFunctionCalling:S,structuredOutputs:this.supportsStructuredOutputs});return{args:{...A,tools:t,tool_choice:r,functions:n,function_call:a},warnings:[...x,...s]}}case"object-json":return{args:{...A,response_format:this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:null!=(E=e.name)?E:"response",description:e.description}}:{type:"json_object"}},warnings:x};case"object-tool":return{args:S?{...A,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...A,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:!!this.supportsStructuredOutputs||void 0}}]},warnings:x};default:throw Error(`Unsupported type: ${I}`)}}async doGenerate(e){var t,r,o,a,l,p,d,m;let{args:g,warnings:h}=this.getArgs(e),{responseHeaders:y,value:v}=await (0,n.GU)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),e.headers),body:g,failedResponseHandler:u,successfulResponseHandler:(0,n.cV)(f),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:b,..._}=g,w=v.choices[0],k=null==(t=v.usage)?void 0:t.completion_tokens_details,E=null==(r=v.usage)?void 0:r.prompt_tokens_details,I={openai:{}};return(null==k?void 0:k.reasoning_tokens)!=null&&(I.openai.reasoningTokens=null==k?void 0:k.reasoning_tokens),(null==k?void 0:k.accepted_prediction_tokens)!=null&&(I.openai.acceptedPredictionTokens=null==k?void 0:k.accepted_prediction_tokens),(null==k?void 0:k.rejected_prediction_tokens)!=null&&(I.openai.rejectedPredictionTokens=null==k?void 0:k.rejected_prediction_tokens),(null==E?void 0:E.cached_tokens)!=null&&(I.openai.cachedPromptTokens=null==E?void 0:E.cached_tokens),{text:null!=(o=w.message.content)?o:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&w.message.function_call?[{toolCallType:"function",toolCallId:(0,n.$C)(),toolName:w.message.function_call.name,args:w.message.function_call.arguments}]:null==(a=w.message.tool_calls)?void 0:a.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:(0,n.$C)(),toolName:e.function.name,args:e.function.arguments}}),finishReason:i(w.finish_reason),usage:{promptTokens:null!=(p=null==(l=v.usage)?void 0:l.prompt_tokens)?p:NaN,completionTokens:null!=(m=null==(d=v.usage)?void 0:d.completion_tokens)?m:NaN},rawCall:{rawPrompt:b,rawSettings:_},rawResponse:{headers:y},request:{body:JSON.stringify(g)},response:c(v),warnings:h,logprobs:s(w.logprobs),providerMetadata:I}}async doStream(e){let t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let r of t.toolCalls)e.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:r.toolCallId,toolName:r.toolName,argsTextDelta:r.args}),e.enqueue({type:"tool-call",...r});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:r,warnings:a}=this.getArgs(e),l={...r,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:p,value:d}=await (0,n.GU)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),e.headers),body:l,failedResponseHandler:u,successfulResponseHandler:(0,n.Ds)(m),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:f,...g}=r,h=[],y="unknown",v={promptTokens:void 0,completionTokens:void 0},b=!0,{useLegacyFunctionCalling:_}=this.settings,w={openai:{}};return{stream:d.pipeThrough(new TransformStream({transform(e,r){var a,l,u,p,d,f,m,g,k,E,I,x;if(!e.success){y="error",r.enqueue({type:"error",error:e.error});return}let S=e.value;if("error"in S){y="error",r.enqueue({type:"error",error:S.error});return}if(b&&(b=!1,r.enqueue({type:"response-metadata",...c(S)})),null!=S.usage){let{prompt_tokens:e,completion_tokens:t,prompt_tokens_details:r,completion_tokens_details:n}=S.usage;v={promptTokens:null!=e?e:void 0,completionTokens:null!=t?t:void 0},(null==n?void 0:n.reasoning_tokens)!=null&&(w.openai.reasoningTokens=null==n?void 0:n.reasoning_tokens),(null==n?void 0:n.accepted_prediction_tokens)!=null&&(w.openai.acceptedPredictionTokens=null==n?void 0:n.accepted_prediction_tokens),(null==n?void 0:n.rejected_prediction_tokens)!=null&&(w.openai.rejectedPredictionTokens=null==n?void 0:n.rejected_prediction_tokens),(null==r?void 0:r.cached_tokens)!=null&&(w.openai.cachedPromptTokens=null==r?void 0:r.cached_tokens)}let A=S.choices[0];if((null==A?void 0:A.finish_reason)!=null&&(y=i(A.finish_reason)),(null==A?void 0:A.delta)==null)return;let T=A.delta;null!=T.content&&r.enqueue({type:"text-delta",textDelta:T.content});let N=s(null==A?void 0:A.logprobs);(null==N?void 0:N.length)&&(void 0===t&&(t=[]),t.push(...N));let j=_&&null!=T.function_call?[{type:"function",id:(0,n.$C)(),function:T.function_call,index:0}]:T.tool_calls;if(null!=j)for(let e of j){let t=e.index;if(null==h[t]){if("function"!==e.type)throw new o.xn({data:e,message:"Expected 'function' type."});if(null==e.id)throw new o.xn({data:e,message:"Expected 'id' to be a string."});if((null==(a=e.function)?void 0:a.name)==null)throw new o.xn({data:e,message:"Expected 'function.name' to be a string."});h[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(l=e.function.arguments)?l:""},hasFinished:!1};let s=h[t];(null==(u=s.function)?void 0:u.name)!=null&&(null==(p=s.function)?void 0:p.arguments)!=null&&(s.function.arguments.length>0&&r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:s.id,toolName:s.function.name,argsTextDelta:s.function.arguments}),(0,n.v0)(s.function.arguments)&&(r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(d=s.id)?d:(0,n.$C)(),toolName:s.function.name,args:s.function.arguments}),s.hasFinished=!0));continue}let s=h[t];!s.hasFinished&&((null==(f=e.function)?void 0:f.arguments)!=null&&(s.function.arguments+=null!=(g=null==(m=e.function)?void 0:m.arguments)?g:""),r.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:s.id,toolName:s.function.name,argsTextDelta:null!=(k=e.function.arguments)?k:""}),(null==(E=s.function)?void 0:E.name)!=null&&(null==(I=s.function)?void 0:I.arguments)!=null&&(0,n.v0)(s.function.arguments)&&(r.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(x=s.id)?x:(0,n.$C)(),toolName:s.function.name,args:s.function.arguments}),s.hasFinished=!0))}},flush(e){var r,n;e.enqueue({type:"finish",finishReason:y,logprobs:t,usage:{promptTokens:null!=(r=v.promptTokens)?r:NaN,completionTokens:null!=(n=v.completionTokens)?n:NaN},...null!=w?{providerMetadata:w}:{}})}})),rawCall:{rawPrompt:f,rawSettings:g},rawResponse:{headers:p},request:{body:JSON.stringify(l)},warnings:a}}},d=a.z.object({prompt_tokens:a.z.number().nullish(),completion_tokens:a.z.number().nullish(),prompt_tokens_details:a.z.object({cached_tokens:a.z.number().nullish()}).nullish(),completion_tokens_details:a.z.object({reasoning_tokens:a.z.number().nullish(),accepted_prediction_tokens:a.z.number().nullish(),rejected_prediction_tokens:a.z.number().nullish()}).nullish()}).nullish(),f=a.z.object({id:a.z.string().nullish(),created:a.z.number().nullish(),model:a.z.string().nullish(),choices:a.z.array(a.z.object({message:a.z.object({role:a.z.literal("assistant").nullish(),content:a.z.string().nullish(),function_call:a.z.object({arguments:a.z.string(),name:a.z.string()}).nullish(),tool_calls:a.z.array(a.z.object({id:a.z.string().nullish(),type:a.z.literal("function"),function:a.z.object({name:a.z.string(),arguments:a.z.string()})})).nullish()}),index:a.z.number(),logprobs:a.z.object({content:a.z.array(a.z.object({token:a.z.string(),logprob:a.z.number(),top_logprobs:a.z.array(a.z.object({token:a.z.string(),logprob:a.z.number()}))})).nullable()}).nullish(),finish_reason:a.z.string().nullish()})),usage:d}),m=a.z.union([a.z.object({id:a.z.string().nullish(),created:a.z.number().nullish(),model:a.z.string().nullish(),choices:a.z.array(a.z.object({delta:a.z.object({role:a.z.enum(["assistant"]).nullish(),content:a.z.string().nullish(),function_call:a.z.object({name:a.z.string().optional(),arguments:a.z.string().optional()}).nullish(),tool_calls:a.z.array(a.z.object({index:a.z.number(),id:a.z.string().nullish(),type:a.z.literal("function").optional(),function:a.z.object({name:a.z.string().nullish(),arguments:a.z.string().nullish()})})).nullish()}).nullish(),logprobs:a.z.object({content:a.z.array(a.z.object({token:a.z.string(),logprob:a.z.number(),top_logprobs:a.z.array(a.z.object({token:a.z.string(),logprob:a.z.number()}))})).nullable()}).nullish(),finish_reason:a.z.string().nullable().optional(),index:a.z.number()})),usage:d}),l]);function g(e){return"o1"===e||e.startsWith("o1-")||"o3"===e||e.startsWith("o3-")}function h(e){var t,r;return g(e)?null!=(r=null==(t=y[e])?void 0:t.systemMessageMode)?r:"developer":"system"}var y={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"}};function v(e){return null==e?void 0:e.tokens.map((t,r)=>({token:t,logprob:e.token_logprobs[r],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[r]).map(([e,t])=>({token:e,logprob:t})):[]}))}var b=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:r,maxTokens:n,temperature:a,topP:s,topK:i,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:p,seed:d}){var f;let m=e.type,g=[];null!=i&&g.push({type:"unsupported-setting",setting:"topK"}),null!=p&&"text"!==p.type&&g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:h,stopSequences:y}=function({prompt:e,inputFormat:t,user:r="user",assistant:n="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let a="";for(let{role:t,content:s}of("system"===e[0].role&&(a+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new o.M3({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=s.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new o.b8({functionality:"images"})}}).join("");a+=`${r}:
${e}

`;break}case"assistant":{let e=s.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new o.b8({functionality:"tool-call messages"})}}).join("");a+=`${n}:
${e}

`;break}case"tool":throw new o.b8({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:a+=`${n}:
`,stopSequences:[`
${r}:`]}}({prompt:r,inputFormat:t}),v=[...null!=y?y:[],...null!=c?c:[]],b={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:a,top_p:s,frequency_penalty:l,presence_penalty:u,seed:d,prompt:h,stop:v.length>0?v:void 0};switch(m){case"regular":if(null==(f=e.tools)?void 0:f.length)throw new o.b8({functionality:"tools"});if(e.toolChoice)throw new o.b8({functionality:"toolChoice"});return{args:b,warnings:g};case"object-json":throw new o.b8({functionality:"object-json mode"});case"object-tool":throw new o.b8({functionality:"object-tool mode"});default:throw Error(`Unsupported type: ${m}`)}}async doGenerate(e){let{args:t,warnings:r}=this.getArgs(e),{responseHeaders:o,value:a}=await (0,n.GU)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),e.headers),body:t,failedResponseHandler:u,successfulResponseHandler:(0,n.cV)(_),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...l}=t,p=a.choices[0];return{text:p.text,usage:{promptTokens:a.usage.prompt_tokens,completionTokens:a.usage.completion_tokens},finishReason:i(p.finish_reason),logprobs:v(p.logprobs),rawCall:{rawPrompt:s,rawSettings:l},rawResponse:{headers:o},response:c(a),warnings:r,request:{body:JSON.stringify(t)}}}async doStream(e){let t;let{args:r,warnings:o}=this.getArgs(e),a={...r,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:s,value:l}=await (0,n.GU)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),e.headers),body:a,failedResponseHandler:u,successfulResponseHandler:(0,n.Ds)(w),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:p,...d}=r,f="unknown",m={promptTokens:Number.NaN,completionTokens:Number.NaN},g=!0;return{stream:l.pipeThrough(new TransformStream({transform(e,r){if(!e.success){f="error",r.enqueue({type:"error",error:e.error});return}let n=e.value;if("error"in n){f="error",r.enqueue({type:"error",error:n.error});return}g&&(g=!1,r.enqueue({type:"response-metadata",...c(n)})),null!=n.usage&&(m={promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens});let o=n.choices[0];(null==o?void 0:o.finish_reason)!=null&&(f=i(o.finish_reason)),(null==o?void 0:o.text)!=null&&r.enqueue({type:"text-delta",textDelta:o.text});let a=v(null==o?void 0:o.logprobs);(null==a?void 0:a.length)&&(void 0===t&&(t=[]),t.push(...a))},flush(e){e.enqueue({type:"finish",finishReason:f,logprobs:t,usage:m})}})),rawCall:{rawPrompt:p,rawSettings:d},rawResponse:{headers:s},warnings:o,request:{body:JSON.stringify(a)}}}},_=a.z.object({id:a.z.string().nullish(),created:a.z.number().nullish(),model:a.z.string().nullish(),choices:a.z.array(a.z.object({text:a.z.string(),finish_reason:a.z.string(),logprobs:a.z.object({tokens:a.z.array(a.z.string()),token_logprobs:a.z.array(a.z.number()),top_logprobs:a.z.array(a.z.record(a.z.string(),a.z.number())).nullable()}).nullish()})),usage:a.z.object({prompt_tokens:a.z.number(),completion_tokens:a.z.number()})}),w=a.z.union([a.z.object({id:a.z.string().nullish(),created:a.z.number().nullish(),model:a.z.string().nullish(),choices:a.z.array(a.z.object({text:a.z.string(),finish_reason:a.z.string().nullish(),index:a.z.number(),logprobs:a.z.object({tokens:a.z.array(a.z.string()),token_logprobs:a.z.array(a.z.number()),top_logprobs:a.z.array(a.z.record(a.z.string(),a.z.number())).nullable()}).nullish()})),usage:a.z.object({prompt_tokens:a.z.number(),completion_tokens:a.z.number()}).nullish()}),l]),k=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.settings.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new o.Ch({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:a,value:s}=await (0,n.GU)({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:u,successfulResponseHandler:(0,n.cV)(E),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.data.map(e=>e.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:a}}}},E=a.z.object({data:a.z.array(a.z.object({embedding:a.z.array(a.z.number())})),usage:a.z.object({prompt_tokens:a.z.number()}).nullish()}),I={"dall-e-3":1,"dall-e-2":10},x=class{constructor(e,t,r){this.modelId=e,this.settings=t,this.config=r,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return null!=(t=null!=(e=this.settings.maxImagesPerCall)?e:I[this.modelId])?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:r,aspectRatio:o,seed:a,providerOptions:s,headers:i,abortSignal:l}){var c,p,d,f;let m=[];null!=o&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=a&&m.push({type:"unsupported-setting",setting:"seed"});let g=null!=(d=null==(p=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:p.call(c))?d:new Date,{value:h,responseHeaders:y}=await (0,n.GU)({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:(0,n.m2)(this.config.headers(),i),body:{model:this.modelId,prompt:e,n:t,size:r,...null!=(f=s.openai)?f:{},response_format:"b64_json"},failedResponseHandler:u,successfulResponseHandler:(0,n.cV)(S),abortSignal:l,fetch:this.config.fetch});return{images:h.data.map(e=>e.b64_json),warnings:m,response:{timestamp:g,modelId:this.modelId,headers:y}}}},S=a.z.object({data:a.z.array(a.z.object({b64_json:a.z.string()}))}),A=function(e={}){var t,r,o;let a=null!=(t=(0,n.ae)(e.baseURL))?t:"https://api.openai.com/v1",s=null!=(r=e.compatibility)?r:"compatible",i=null!=(o=e.name)?o:"openai",l=()=>({Authorization:`Bearer ${(0,n.WL)({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),u=(t,r={})=>new p(t,r,{provider:`${i}.chat`,url:({path:e})=>`${a}${e}`,headers:l,compatibility:s,fetch:e.fetch}),c=(t,r={})=>new b(t,r,{provider:`${i}.completion`,url:({path:e})=>`${a}${e}`,headers:l,compatibility:s,fetch:e.fetch}),d=(t,r={})=>new k(t,r,{provider:`${i}.embedding`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),f=(t,r={})=>new x(t,r,{provider:`${i}.image`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),m=(e,t)=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return"gpt-3.5-turbo-instruct"===e?c(e,t):u(e,t)},g=function(e,t){return m(e,t)};return g.languageModel=m,g.chat=u,g.completion=c,g.embedding=d,g.textEmbedding=d,g.textEmbeddingModel=d,g.image=f,g.imageModel=f,g}({compatibility:"strict"})},79889:(e,t,r)=>{r.d(t,{u:()=>H});var n,o,a="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},s="1.9.0",i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,l=function(e){var t=new Set([e]),r=new Set,n=e.match(i);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=o.prerelease)return function(t){return t===e};function a(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var n=e.match(i);if(!n)return a(e);var s={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=s.prerelease||o.major!==s.major)return a(e);if(0===o.major)return o.minor===s.minor&&o.patch<=s.patch?(t.add(e),!0):a(e);return o.minor<=s.minor?(t.add(e),!0):a(e)}}(s),u=Symbol.for("opentelemetry.js.api."+s.split(".")[0]);function c(e,t,r,n){void 0===n&&(n=!1);var o,i=a[u]=null!==(o=a[u])&&void 0!==o?o:{version:s};if(!n&&i[e]){var l=Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(l.stack||l.message),!1}if(i.version!==s){var l=Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+s);return r.error(l.stack||l.message),!1}return i[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+s+"."),!0}function p(e){var t,r,n=null===(t=a[u])||void 0===t?void 0:t.version;if(n&&l(n))return null===(r=a[u])||void 0===r?void 0:r[e]}function d(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+s+".");var r=a[u];r&&delete r[e]}var f=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,n){var o=new e(r._currentContext);return o._currentContext.set(t,n),o},r.deleteValue=function(t){var n=new e(r._currentContext);return n._currentContext.delete(t),n}},m=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return s},g=function(e,t,r){if(r||2==arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},h=function(){function e(){}return e.prototype.active=function(){return f},e.prototype.with=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return t.call.apply(t,g([r],m(n),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),y=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return s},v=function(e,t,r){if(r||2==arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},b=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("verbose",this._namespace,e)},e}();function _(e,t,r){var n=p("diag");if(n)return r.unshift(t),n[e].apply(n,v([],y(r),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(n||(n={}));var w=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return s},k=function(e,t,r){if(r||2==arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},E=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=p("diag");if(n)return n[e].apply(n,k([],w(t),!1))}}var t=this;t.setLogger=function(e,r){if(void 0===r&&(r={logLevel:n.INFO}),e===t){var o,a,s,i=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(o=i.stack)&&void 0!==o?o:i.message),!1}"number"==typeof r&&(r={logLevel:r});var l=p("diag"),u=function(e,t){function r(r,n){var o=t[r];return"function"==typeof o&&e>=n?o.bind(t):function(){}}return e<n.NONE?e=n.NONE:e>n.ALL&&(e=n.ALL),t=t||{},{error:r("error",n.ERROR),warn:r("warn",n.WARN),info:r("info",n.INFO),debug:r("debug",n.DEBUG),verbose:r("verbose",n.VERBOSE)}}(null!==(a=r.logLevel)&&void 0!==a?a:n.INFO,e);if(l&&!r.suppressOverrideMessage){var d=null!==(s=Error().stack)&&void 0!==s?s:"<failed to generate stacktrace>";l.warn("Current logger will be overwritten from "+d),u.warn("Current logger will overwrite one already registered from "+d)}return c("diag",u,t,!0)},t.disable=function(){d("diag",t)},t.createComponentLogger=function(e){return new b(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),I=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return s},x=function(e,t,r){if(r||2==arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},S="context",A=new h,T=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return c(S,e,E.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this._getContextManager()).with.apply(n,x([e,t,r],I(o),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return p(S)||A},e.prototype.disable=function(){this._getContextManager().disable(),d(S,E.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(o||(o={}));var N="0000000000000000",j="00000000000000000000000000000000",C={traceId:j,spanId:N,traceFlags:o.NONE},z=function(){function e(e){void 0===e&&(e=C),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),O=Symbol.for("OpenTelemetry Context Key SPAN");function R(e){return e.getValue(O)||void 0}function P(){return R(T.getInstance().active())}function $(e,t){return e.setValue(O,t)}function M(e){return e.deleteValue(O)}function L(e,t){return $(e,new z(t))}function D(e){var t;return null===(t=R(e))||void 0===t?void 0:t.spanContext()}var F=/^([0-9a-f]{32})$/i,Z=/^[0-9a-f]{16}$/i;function Y(e){var t,r;return t=e.traceId,F.test(t)&&t!==j&&(r=e.spanId,Z.test(r)&&r!==N)}function U(e){return new z(e)}var B=T.getInstance(),q=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=B.active()),null==t?void 0:t.root)return new z;var n,o=r&&D(r);return"object"==typeof(n=o)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&Y(o)?new z(o):new z},e.prototype.startActiveSpan=function(e,t,r,n){if(!(arguments.length<2)){2==arguments.length?s=t:3==arguments.length?(o=t,s=r):(o=t,a=r,s=n);var o,a,s,i=null!=a?a:B.active(),l=this.startSpan(e,o,i),u=$(i,l);return B.with(u,s,void 0,l)}},e}(),V=new q,J=function(){function e(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,n){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):V},e}(),K=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new q},e}()),G=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var n;return null!==(n=this.getDelegateTracer(e,t,r))&&void 0!==n?n:new J(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:K},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,r)},e}(),W="trace",H=(function(){function e(){this._proxyTracerProvider=new G,this.wrapSpanContext=U,this.isSpanContextValid=Y,this.deleteSpan=M,this.getSpan=R,this.getActiveSpan=P,this.getSpanContext=D,this.setSpan=$,this.setSpanContext=L}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=c(W,this._proxyTracerProvider,E.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return p(W)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){d(W,E.instance()),this._proxyTracerProvider=new G},e})().getInstance()},83082:(e,t,r)=>{var n=r(49641).Buffer;let o=void 0!==n,a=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function i(e,t,r){null==r&&null!==t&&"object"==typeof t&&(r=t,t=void 0),o&&n.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let i=JSON.parse(e,t);if(null===i||"object"!=typeof i)return i;let u=r&&r.protoAction||"error",c=r&&r.constructorAction||"error";if("ignore"===u&&"ignore"===c)return i;if("ignore"!==u&&"ignore"!==c){if(!1===a.test(e)&&!1===s.test(e))return i}else if("ignore"!==u&&"ignore"===c){if(!1===a.test(e))return i}else if(!1===s.test(e))return i;return l(i,{protoAction:u,constructorAction:c,safe:r&&r.safe})}function l(e,{protoAction:t="error",constructorAction:r="error",safe:n}={}){let o=[e];for(;o.length;){let e=o;for(let a of(o=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(a,"__proto__")){if(!0===n)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete a.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(a,"constructor")&&Object.prototype.hasOwnProperty.call(a.constructor,"prototype")){if(!0===n)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete a.constructor}for(let e in a){let t=a[e];t&&"object"==typeof t&&o.push(t)}}}return e}function u(e,t,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,r)}finally{Error.stackTraceLimit=n}}e.exports=u,e.exports.default=u,e.exports.parse=u,e.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},e.exports.scan=l},99143:(e,t,r)=>{r.d(t,{Ch:()=>en,Di:()=>C,Kq:()=>J,M3:()=>P,Tt:()=>S,b8:()=>ed,bD:()=>v,eM:()=>Q,hL:()=>k,iM:()=>el,u1:()=>A,u6:()=>U,xn:()=>D});var n,o,a,s,i,l,u,c,p,d,f,m,g="vercel.ai.error",h=Symbol.for(g),y=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[n]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,g)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};n=h;var v=y,b="AI_APICallError",_=`vercel.ai.error.${b}`,w=Symbol.for(_),k=class extends v{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:a,responseBody:s,cause:i,isRetryable:l=null!=n&&(408===n||409===n||429===n||n>=500),data:u}){super({name:b,message:e,cause:i}),this[o]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=a,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return v.hasMarker(e,_)}};o=w;var E="AI_EmptyResponseBodyError",I=`vercel.ai.error.${E}`,x=Symbol.for(I),S=class extends v{constructor({message:e="Empty response body"}={}){super({name:E,message:e}),this[a]=!0}static isInstance(e){return v.hasMarker(e,I)}};function A(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}a=x;var T="AI_InvalidArgumentError",N=`vercel.ai.error.${T}`,j=Symbol.for(N),C=class extends v{constructor({message:e,cause:t,argument:r}){super({name:T,message:e,cause:t}),this[s]=!0,this.argument=r}static isInstance(e){return v.hasMarker(e,N)}};s=j;var z="AI_InvalidPromptError",O=`vercel.ai.error.${z}`,R=Symbol.for(O),P=class extends v{constructor({prompt:e,message:t,cause:r}){super({name:z,message:`Invalid prompt: ${t}`,cause:r}),this[i]=!0,this.prompt=e}static isInstance(e){return v.hasMarker(e,O)}};i=R;var $="AI_InvalidResponseDataError",M=`vercel.ai.error.${$}`,L=Symbol.for(M),D=class extends v{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:$,message:t}),this[l]=!0,this.data=e}static isInstance(e){return v.hasMarker(e,M)}};l=L;var F="AI_JSONParseError",Z=`vercel.ai.error.${F}`,Y=Symbol.for(Z),U=class extends v{constructor({text:e,cause:t}){super({name:F,message:`JSON parsing failed: Text: ${e}.
Error message: ${A(t)}`,cause:t}),this[u]=!0,this.text=e}static isInstance(e){return v.hasMarker(e,Z)}};u=Y;var B="AI_LoadAPIKeyError",q=`vercel.ai.error.${B}`,V=Symbol.for(q),J=class extends v{constructor({message:e}){super({name:B,message:e}),this[c]=!0}static isInstance(e){return v.hasMarker(e,q)}};c=V;var K=Symbol.for("vercel.ai.error.AI_LoadSettingError"),G=Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),W="AI_NoSuchModelError",H=`vercel.ai.error.${W}`,X=Symbol.for(H),Q=class extends v{constructor({errorName:e=W,modelId:t,modelType:r,message:n=`No such ${r}: ${t}`}){super({name:e,message:n}),this[p]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return v.hasMarker(e,H)}};p=X;var ee="AI_TooManyEmbeddingValuesForCallError",et=`vercel.ai.error.${ee}`,er=Symbol.for(et),en=class extends v{constructor(e){super({name:ee,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[d]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return v.hasMarker(e,et)}};d=er;var eo="AI_TypeValidationError",ea=`vercel.ai.error.${eo}`,es=Symbol.for(ea),ei=class e extends v{constructor({value:e,cause:t}){super({name:eo,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${A(t)}`,cause:t}),this[f]=!0,this.value=e}static isInstance(e){return v.hasMarker(e,ea)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};f=es;var el=ei,eu="AI_UnsupportedFunctionalityError",ec=`vercel.ai.error.${eu}`,ep=Symbol.for(ec),ed=class extends v{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:eu,message:t}),this[m]=!0,this.functionality=e}static isInstance(e){return v.hasMarker(e,ec)}};function ef(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(ef):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&ef(t)))}m=ep}}]);