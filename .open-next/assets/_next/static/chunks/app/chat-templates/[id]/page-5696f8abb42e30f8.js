(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3715],{38673:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(95155),i=s(12115),l=s(35695),c=s(66320),r=s(88262),n=s(30285),o=s(35169),d=s(67720);function m(e){let t=(0,i.use)(e.params),{data:s}=(0,c.wV)(),m=(0,l.useRouter)(),{toast:h}=(0,r.dj)(),[u,p]=(0,i.useState)(null),[x,f]=(0,i.useState)(!0),[v,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{if(null==s?void 0:s.user)try{let e=await fetch("/api/chat-templates/".concat(t.id));if(!e.ok){if(404===e.status){h({title:"Template not found",description:"The requested template does not exist",variant:"destructive"}),m.push("/chat-templates");return}throw Error("Failed to fetch template")}let s=await e.json();p(s)}catch(e){h({title:"Error",description:"Failed to load template",variant:"destructive"})}finally{f(!1)}})()},[s,t.id,m,h]);let y=async e=>{if(u){j(!0);try{if(!(await fetch("/api/chat-templates/".concat(u.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update template");h({title:"Success",description:"Template updated successfully"}),p({...u,...e})}catch(e){h({title:"Error",description:"Failed to update template",variant:"destructive"})}finally{j(!1)}}},N=async()=>{if(u&&confirm("Are you sure you want to delete this template? This action cannot be undone."))try{if(!(await fetch("/api/chat-templates/".concat(u.id),{method:"DELETE"})).ok)throw Error("Failed to delete template");h({title:"Success",description:"Template deleted successfully"}),m.push("/chat-templates")}catch(e){h({title:"Error",description:"Failed to delete template",variant:"destructive"})}},b=u&&(null==s?void 0:s.user)&&u.userId===s.user.id;return x?(0,a.jsx)("div",{className:"container mx-auto py-8 flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):u?b?(0,a.jsxs)("div",{className:"container mx-auto py-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsxs)(n.$,{variant:"ghost",onClick:()=>m.push("/chat-templates"),className:"mr-4",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Template"})]}),(0,a.jsx)(d.A,{initialValues:u,onSubmit:y,isSubmitting:v,onDelete:N})]}):(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Permission Denied"}),(0,a.jsx)("p",{className:"mb-6",children:"You don't have permission to edit this template."}),(0,a.jsxs)(n.$,{onClick:()=>m.push("/chat-templates"),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Back to Templates"]})]})}):(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Template not found"}),(0,a.jsx)("p",{className:"mb-6",children:"The requested template does not exist or you don't have permission to view it."}),(0,a.jsxs)(n.$,{onClick:()=>m.push("/chat-templates"),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Back to Templates"]})]})})}},39335:(e,t,s)=>{Promise.resolve().then(s.bind(s,38673))}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,1603,8595,4052,9205,6544,273,8441,1684,7358],()=>t(39335)),_N_E=e.O()}]);